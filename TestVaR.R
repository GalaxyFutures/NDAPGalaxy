prices = c(100.7605972,100.7385025,100.7441025,100.6414032,100.5487976,100.4633026,100.4577026,100.6464996,100.706398,100.2929001,100.3308029,100.2434006,100.3143005,100.2446976,100.3014984,100.3021011,100.3014984,100.1585999,99.69670105,99.59470367,99.30580139,99.19629669,98.80439758,98.70189667,98.8615036,98.94439697,98.95939636,99.02459717,98.99629974,99.24949646,99.4151001,99.56559753,99.62200165,99.43579865,99.37280273,99.26950073,99.29229736,99.41570282,99.45050049,99.4280014,99.36910248,99.30370331,99.25789642,99.24590302,99.13569641,99.01699829,98.99549866,98.8588028,98.90049744,98.88870239,98.83750153,98.77380371,98.76319885,98.72789764,98.7410965,98.78890228,98.79000092,98.75569916,98.64219666,98.61589813,98.67279816,98.72969818,98.80290222,98.84770203,98.80139923,98.81009674,98.70659637,98.62889862,98.56400299,98.49130249,98.46929932,98.46820068,98.45379639,98.41999817,98.39179993,98.38950348,98.37049866,98.27149963,98.31569672,98.26039886,98.26399994,98.25099945,98.23419952,98.2016983,98.18910217,98.08509827,98.08070374,98.05480194,98.05950165,98.05200195,98.1006012,98.19159698,98.28549957,98.31909943,98.209198,98.32009888,98.39710236,98.40589905,98.39499664,98.38909912,98.29989624,98.3187027,98.31559753,98.36699677,98.46659851,98.57520294,98.71720123,98.76709747,98.71800232,98.71179962,98.62290192,98.66190338,98.61000061,98.65409851,98.6964035,98.70510101,98.79319763,98.80770111,98.8309021,98.92569733,98.95960236,98.98280334,99.07969666,99.11489868,99.20230103,99.24859619,99.20680237,99.16770172,99.10430145,99.09989929,99.17250061,99.21880341,99.19580078,99.2315979,99.21859741,99.18499756,99.26789856,99.15039825,99.12940216,99.09059906,99.08789825,99.08570099,99.11630249,99.0684967,99.12049866,99.09980011,99.15940094,99.16790009,99.23480225,99.23459625,99.36319733,99.58029938,99.73750305,100.0677032,100.2105026,100.2529984,100.2465973,100.1924973,100.2983017,100.5098038,100.5080032,100.5670013,100.441803,100.2565002,100.3153,100.4296036,100.3991013,100.4653015,100.6166992,100.581398,100.5205002,100.5419006,100.52320098877,100.576202392578,100.592597961426,100.3528,100.388,100.844902038574,100.86799621582,100.850303649902,100.828598022461,100.778099060059,100.856002807617,100.854499816895,100.844902038574,100.865303039551,100.953201293945,100.953300476074,100.952301025391,100.925201416016,100.864097595215,100.792098999023,100.716903686523,100.70240020752,100.616996765137,100.566101074219,100.396202087402,100.390602111816,100.249900817871,100.039901733398,98.8219985961914,99.0322036743164,98.9969024658203,99.1727981567383,99.8461990356445,100.205703735352,100.273002624512,100.359703063965,100.429298400879,100.452903747559,100.444297790527,100.481399536133,100.443496704102,100.414001464844,100.277397155762,100.002197265625,99.8694000244141,99.9150009155273,99.6047973632813,99.4593963623047,99.4375991821289,99.2408981323242,98.9466018676758,98.6436004638672,98.6064987182617,98.9226989746094,98.9402008056641,98.9028015136719,98.8507995605469,98.8317031860352,98.9469985961914,98.9362030029297,98.8817977905273,98.8292999267578,98.7212982177734,98.5333023071289,98.2580032348633,98.2060012817383,97.4188995361328,97.2097015380859,96.7985000610352)
dQuanileLevel = 0.01
dCurrentPrice = 96.7985000610352
bHistoricMethod = TRUE
result = CalculateVaR(prices,dQuanileLevel,dCurrentPrice,bHistoricMethod)